# 사용 매뉴얼

## 📋 전체 워크플로우

```
1. 국토부 사이트에서 Excel 다운로드
   ↓
2. Upload 페이지에서 Excel 업로드
   ↓
3. Supabase에 자동 저장
   ↓
4. Report 페이지에서 리포트 생성
   ↓
5. 티스토리 블로그에 복사/붙여넣기
```

## 1️⃣ 국토부 실거래가 데이터 다운로드

### 단계별 가이드

1. **국토교통부 실거래가 공개시스템** 접속
   - URL: https://rt.molit.go.kr/

2. **아파트 전월세 자료 실거래 자료 조회** 선택

3. **검색 조건 입력**
   - 지역: 경기도 > 하남시
   - 기간: 원하는 기간 선택 (예: 2025.11.01 ~ 2025.11.07)
   - 거래 유형: 전월세

4. **조회 버튼 클릭**

5. **Excel 다운로드**
   - 조회 결과에서 "엑셀 다운로드" 버튼 클릭
   - 파일명 예시: `아파트전월세_실거래가_20251101_20251107.xlsx`

## 2️⃣ Excel 파일 업로드

1. **Upload 페이지 접속**
   - http://localhost:3000/upload (로컬)
   - 또는 배포된 URL/upload

2. **파일 선택**
   - "Excel 파일 선택" 버튼 클릭
   - 다운로드한 국토부 Excel 파일 선택

3. **업로드 실행**
   - "업로드" 버튼 클릭
   - 진행 상황 확인

4. **결과 확인**
   - ✅ 성공: "XX건의 거래가 저장되었습니다" 메시지
   - ❌ 실패: 에러 메시지 확인 (파일 형식, API 키 등)

### 💡 업로드 팁

- **파일 형식**: `.xlsx` 또는 `.xls` 파일만 가능
- **데이터 형식**: 국토부 표준 Excel 형식이어야 함 (13행부터 데이터 시작)
- **중복 저장**: 같은 데이터를 여러 번 업로드하면 중복 저장됨 (추후 개선 예정)

## 3️⃣ 리포트 생성

1. **Report 페이지 접속**
   - http://localhost:3000/report (로컬)
   - 또는 배포된 URL/report

2. **기간 키 입력**
   - 형식: `YYYY-MM-WN` (N은 주차)
   - 예시:
     - `2025-11-W1` → 2025년 11월 1주차 (1~7일)
     - `2025-11-W2` → 2025년 11월 2주차 (8~14일)
     - `2025-12-W4` → 2025년 12월 4주차 (22일~)

3. **리포트 생성 버튼 클릭**
   - "리포트 생성" 버튼 클릭
   - 잠시 대기 (보통 1~2초)

4. **결과 확인**
   - 📊 요약 정보: 전체/신규/갱신/전세/월세 건수 표시
   - 📝 블로그 텍스트: 티스토리용 텍스트
   - 🎨 HTML 테이블: 티스토리용 HTML 표

## 4️⃣ 티스토리 블로그 작성

### 방법 1: 텍스트 복사

1. "블로그 텍스트" 섹션에서 **"📋 복사하기"** 버튼 클릭
2. 티스토리 관리자 > 글쓰기
3. 본문에 붙여넣기 (Ctrl+V)
4. 필요에 따라 편집

### 방법 2: HTML 테이블 복사

1. "HTML 테이블" 섹션에서 **"📋 복사하기"** 버튼 클릭
2. 티스토리 글쓰기 > **HTML 모드** 전환
3. 붙여넣기 (Ctrl+V)
4. 다시 **기본 모드**로 전환하여 확인

### 💡 티스토리 작성 팁

- **서론 + 표 조합**: 텍스트와 HTML을 함께 사용하면 완성도 높은 포스트
- **이미지 추가**: 지역 지도, 아파트 단지 사진 등 추가 권장
- **해시태그**: #하남시전월세 #실거래가 #아파트 등
- **카테고리**: 부동산, 지역정보 등

## 📊 주차별 기간 계산 가이드

| 주차 | 포함 날짜 | period_key 예시 |
|------|-----------|-----------------|
| W1   | 1일 ~ 7일 | 2025-11-W1      |
| W2   | 8일 ~ 14일 | 2025-11-W2      |
| W3   | 15일 ~ 21일 | 2025-11-W3      |
| W4   | 22일 ~ 말일 | 2025-11-W4      |

### 예시

- **2025년 11월 5일 계약** → `2025-11-W1`
- **2025년 12월 15일 계약** → `2025-12-W3`
- **2025년 10월 28일 계약** → `2025-10-W4`

## 🔄 반복 작업 플로우

매주 새로운 리포트를 작성하는 경우:

```
1. 매주 월요일 또는 특정 요일에:
   - 국토부 사이트에서 지난 주 데이터 다운로드
   
2. Upload 페이지에서 업로드

3. Report 페이지에서:
   - 해당 주차의 period_key 입력 (예: 2025-11-W1)
   - 리포트 생성
   
4. 티스토리에:
   - 텍스트 복사
   - HTML 테이블 복사
   - 제목: "2025년 11월 1주차 하남시 아파트 전월세 실거래 정리"
   - 발행
```

## 🎯 활용 예시

### 예시 1: 주간 리포트
- **주기**: 매주
- **제목**: "YYYY년 MM월 N주차 하남시 아파트 전월세 실거래 정리"
- **내용**: 텍스트 + 표

### 예시 2: 월간 요약
- 각 주차별 리포트 링크 모음
- 월별 통계 종합

### 예시 3: 단지별 분석
- 특정 단지에 대한 깊이 있는 분석
- 과거 데이터와 비교

## ❓ FAQ

### Q1. 같은 데이터를 여러 번 업로드하면?
A. 현재는 중복으로 저장됩니다. Supabase에서 수동 삭제 필요.

### Q2. 다른 지역(성남시, 용인시 등)도 가능한가요?
A. 현재는 하남시만 지원. 코드 수정으로 확장 가능.

### Q3. period_key를 잘못 입력하면?
A. "해당 기간의 데이터가 없습니다" 에러 발생. 올바른 기간 키로 재입력.

### Q4. 리포트 텍스트를 수정하고 싶어요.
A. `lib/renderPost.ts` 파일을 편집하여 템플릿 수정 가능.

### Q5. HTML 테이블 스타일을 변경하고 싶어요.
A. `lib/renderTables.ts` 파일에서 CSS 스타일 수정 가능.

## 🆘 문제 해결

### 업로드 실패
1. `.env.local` 파일 확인
2. Supabase API 키 확인
3. Excel 파일 형식 확인 (국토부 표준 형식)
4. 개발자 도구(F12) > Console에서 에러 확인

### 리포트 생성 실패
1. period_key 형식 확인 (`YYYY-MM-WN`)
2. 해당 기간의 데이터가 업로드되었는지 Supabase에서 확인
3. Supabase 연결 상태 확인

### 복사 버튼이 작동하지 않음
1. HTTPS 환경인지 확인 (로컬은 http://localhost도 가능)
2. 브라우저 클립보드 권한 확인
3. 다른 브라우저에서 시도

## 📞 추가 도움

- **GitHub Issues**: 버그 리포트 및 기능 제안
- **README.md**: 기술 문서
- **SETUP_GUIDE.md**: 설치 가이드

---

즐거운 블로깅 되세요! 🎉
